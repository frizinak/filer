<?php
define('FILER_CRON', 'filer:cron');

/**
 * Implements hook_cron_queue_info().
 */
function filer_cron_queue_info() {
  $queues[FILER_CRON] = array(
    'worker callback' => 'filer_cron_callback',
    'time' => 30,
  );

  return $queues;
}

/**
 * Main cron callback.
 * This function will open the file and write the return value of the given callback function, if the return value is a string.
 * Passes the provided data, file contents, the filehandle and a status indicator to the callback.
 * Status indicator will be 'first', empty or 'last'.
 */
function filer_cron_callback($data) {
  $filer = new Filer($data['id']);
  $filer->process($data['frid'], $data['filepath'], $data['data'], $data['fmode'], $data['read'], $data['status']);
}
